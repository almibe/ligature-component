// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Ligature from "./Ligature.res.mjs";
import * as Core__List from "@rescript/core/src/Core__List.res.mjs";
import * as WanderParser from "./WanderParser.res.mjs";

function run(script, actions, networks) {
  var values = WanderParser.parse(script);
  if (values.TAG !== "Ok") {
    return {
            TAG: "Error",
            _0: values._0
          };
  }
  values._0.forEach(function (expression) {
        
      });
  return {
          TAG: "Ok",
          _0: [
            networks,
            /* [] */0
          ]
        };
}

function executeAction(action, actions, networks, stack) {
  throw {
        RE_EXN_ID: "Failure",
        _1: "not complete",
        Error: new Error()
      };
}

function $$eval(atom, actions, networks, stack) {
  if (atom.TAG !== "Element") {
    return {
            TAG: "Ok",
            _0: [
              networks,
              Core__List.add(stack, atom)
            ]
          };
  }
  throw {
        RE_EXN_ID: "Failure",
        _1: "not complete",
        Error: new Error()
      };
}

function printResult(value) {
  if (value.TAG === "Ok") {
    return Ligature.printNetwork(value._0);
  } else {
    return value._0;
  }
}

function toJs(result) {
  if (result.TAG !== "Ok") {
    return {
            NAME: "Error",
            VAL: result._0
          };
  }
  var result$1 = [];
  result._0.forEach(function (triple) {
        var e = triple.element;
        var element;
        element = e.TAG === "Element" ? ({
              type: "element",
              value: e._0.value
            }) : ({
              type: "slot",
              value: e._0.value
            });
        var e$1 = triple.role;
        var role;
        role = e$1.TAG === "Element" ? ({
              type: "element",
              value: e$1._0.value
            }) : ({
              type: "slot",
              value: e$1._0.value
            });
        var e$2 = triple.value;
        var value;
        switch (e$2.TAG) {
          case "VElement" :
              value = {
                type: "element",
                value: e$2._0.value
              };
              break;
          case "VSlot" :
              value = {
                type: "slot",
                value: e$2._0.value
              };
              break;
          case "VLiteral" :
              value = {
                type: "literal",
                value: e$2._0.value
              };
              break;
          case "VQuote" :
          case "VNetwork" :
              throw {
                    RE_EXN_ID: "Match_failure",
                    _1: [
                      "Wander.res",
                      91,
                      20
                    ],
                    Error: new Error()
                  };
          
        }
        result$1.push({
              type: "triple",
              element: element,
              role: role,
              value: value
            });
      });
  return {
          NAME: "Network",
          VAL: result$1
        };
}

export {
  run ,
  executeAction ,
  $$eval ,
  printResult ,
  toJs ,
}
/* WanderParser Not a pure module */
